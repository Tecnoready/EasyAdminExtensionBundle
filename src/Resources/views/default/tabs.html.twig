<ul class="nav nav-tabs" style="margin: 0;">
    <li class="tab-title">
        {% if tab.icon %}
            <i class="{{ tab.icon }}"></i>
        {% else %}
            <i class="fa fa-check"></i>
        {% endif %}
        &nbsp;
        {{ tab.name|trans }}
    </li>
    <li>
        <ul id="{{ tab.id }}" class="nav nav-tabs" style="margin: 0;">
            {% for tabContent in tab.tabsContent if tabContent.type == constant("AlterPHP\\EasyAdminExtensionBundle\\Model\\Tab\\Tab::TAB_CONTENT") %}
                <li {% if loop.first %}class="active"{% endif%}>
                    <a data-toggle="tab" href="#{{ tabContent.id }}" title="{{ tabContent.title }}" {% if tabContent.route is not null %}tab-ajax="true" data-url="{{ url(tabContent.route,tabContent.routeParameters) }}"{% endif %}>
                        {% if tabContent.icon is not null %}<i class="{{ tabContent.icon }}"></i>&nbsp;{% endif %}{{ tabContent.title|trans }}
                    </a>
                </li>
            {% endfor %}
        </ul>
    </li>
</ul>
<div class="tab-content">
    {% for tabContent in tab.tabsContent if tabContent.type == constant("AlterPHP\\EasyAdminExtensionBundle\\Model\\Tab\\Tab::TAB_CONTENT") %}
        <div class="tab-pane {% if loop.first %}active{% endif%}" id="{{ tabContent.id }}">
            {% for field, metadata in tabContent.fields %}
                {% include 'EasyAdminExtensionBundle:default:field_show.html.twig' %}
            {% endfor %}
        </div>
    {% endfor %}
</div>
<div id="lo-{{ tab.id }}" class="hide">
    <div class="tab-pane l-loading-container">
        {{ "Loading content"|trans }}
        <div class='loading'><p class='blocktext'>
                
                <span class='ellipsis_animated-inner'>
                <span>.</span>
                <span>.</span>
                <span>.</span>
            </span></p></div></div>
</div>
<script>
    if(tabsService === undefined){
        var tabsService = {
            id: null,
            isReloading: false,
            lastTabContentId: null,
            setId: function(id){
                this.id = id;
            },
            reload: function(){
                this.isReloading = true;
                $("#"+tabsService.id+" > li.active > a").click();
            },
            done: function(){
                this.isReloading = false;
            },
            loading: function(){
                $("#"+tabsService.id).html($("#lo-"+tabsService.id).html());
            },
            loadContent: function(url,tabContentId){
                if(tabContentId){
                    this.lastTabContentId = tabContentId;
                }
                var self = $(this.lastTabContentId);
                $(this.lastTabContentId).html($("#lo-"+tabsService.id).html());
                $(this.lastTabContentId).load(url+'?ajax=true', function(response, status, xhr){
                    $('#'+tabsService.id).tab(); //reinitialize tabs
                    if(status == "error"){
                        self.html("<b>{{ "modal.error.loading.content"|trans }}</b> <br/><br/>"+ xhr.status + " " + xhr.statusText);
                    }
                });
            }
        };
    }
    $(function() {
        tabsService.setId("{{ tab.id }}");
        $('[tab-ajax="true"]').click(function(e) {
            e.preventDefault();
            $this = $(this);
            if(tabsService.isReloading === false && $this.parent().hasClass("active") == true){
                return;
            }
            tabsService.done();
            var tabContent = $(this).attr('href');
            var loadurl = $(this).attr('data-url');
            tabsService.loadContent(loadurl,tabContent);
        });
    });
</script>
<style>
    .tab-title {
        padding: 11px;
        background-color: #0071BD;
        color: #fff;
    }
    .tab-content {
        background-color: #ffffff;
        padding: 16px 12px;
        position: relative;
        -webkit-box-shadow: 1px 0 10px 1px rgba(0, 0, 0, 0.3);
        -moz-box-shadow: 1px 0 10px 1px rgba(0, 0, 0, 0.3);
        box-shadow: 1px 0 10px 1px rgba(0, 0, 0, 0.3);
        margin-bottom: 20px;
        min-height: 16em;
    }
</style>